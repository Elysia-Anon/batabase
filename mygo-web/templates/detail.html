{% extends 'layout.html' %}

{% block content %}
<style>
    .stats-grid-mobile {
        display: grid !important;
        grid-template-columns: 1fr 1fr !important;
        gap: 10px;
        margin-bottom: 20px;
    }
    .stats-grid-mobile h3 { font-size: 1.5rem !important; margin-bottom: 5px; }
    .stats-grid-mobile small { font-size: 0.8rem; }

    .role-badge {
        white-space: nowrap;
        font-size: 0.75rem;
        padding: 4px 8px;
        border-radius: 4px;
        display: inline-block;
        background-color: #f1c40f;
        color: #000;
        font-weight: bold;
    }

   
    @media (max-width: 600px) {
        .hide-on-mobile { display: none; }
        table { font-size: 0.9rem; }
    }
</style>

<nav aria-label="breadcrumb">
  <ul>
    <li><a href="/">é¦–é¡µ</a></li>
    <li>{{ band.name }}</li>
  </ul>
</nav>

<hgroup>
    <h1>{{ band.name }}</h1>
    <h2>é˜Ÿé•¿: {{ band.leader_name }} | æˆå‘˜æ•°: {{ band.member_count }}äºº</h2>
</hgroup>

{% if stats %}
<article>
    <header><strong>ğŸ“Š ç²‰ä¸å¤§æ•°æ®</strong></header>
    <div class="grid stats-grid-mobile" style="text-align: center;">
        <div>
            <h3>{{ stats['ç²‰ä¸æ€»æ•°'] }}</h3>
            <small>æ€»å…³æ³¨</small>
        </div>
        <div>
            <h3>{{ stats['å¹³å‡å¹´é¾„'] | float | round(1) }} å²</h3>
            <small>å¹³å‡å¹´é¾„</small>
        </div>
        <div>
            <h3>{{ stats['å¥³æ€§ç²‰ä¸æ•°'] }}</h3>
            <small>å¥³æ€§ç²‰ä¸</small>
        </div>
        <div>
            <h3>{{ stats['æœ¬ç§‘ç²‰ä¸æ•°'] }}</h3>
            <small>æœ¬ç§‘åŠä»¥ä¸Š</small>
        </div>
    </div>
</article>
{% endif %}

<h3>ğŸ¤ æˆå‘˜åå•</h3>
<figure>
    <table role="grid">
        <thead>
            <tr>
                <th scope="col">å§“å</th>
                <th scope="col">æ‹…å½“</th>
                <th scope="col" class="hide-on-mobile">æ€§åˆ«</th>
                <th scope="col" class="hide-on-mobile">å¹´é¾„</th>
                <th scope="col">åŠ å…¥æ—¶é—´</th>
            </tr>
        </thead>
        <tbody>
            {% for m in members %}
            <tr>
                <th scope="row">{{ m.name }}</th>
                <td>
                    <span class="role-badge">{{ m.role }}</span>
                </td>
                <td class="hide-on-mobile">{{ m.gender }}</td>
                <td class="hide-on-mobile">{{ m.age }}</td>
                <td>{{ m.join_date|string|truncate(10, True, '') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</figure>

<hr>

{% if user and user.type == 'fan' %}
    <article>
        <header><strong>ğŸ“ å‘è¡¨ä¹è¯„ </strong></header>
        <form action="/add_review" method="POST">
            <input type="hidden" name="album_id" value="1"> 
            <div class="grid">
                <label>
                    è¯„åˆ† (0-10)
                    <input type="number" name="score" min="0" max="10" step="0.1" required placeholder="9.5">
                </label>
                <label>
                    è¯„è®ºå†…å®¹
                    <input type="text" name="comment" placeholder="ç¥ä¸“ï¼å¹çˆ†ï¼" required>
                </label>
            </div>
            <button type="submit">æäº¤å¹¶è§¦å‘æ¦œå•æ›´æ–°</button>
        </form>
    </article>
{% elif not user %}
    <div style="text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 8px;">
        ğŸ’¡ æƒ³è¦æ‰“åˆ†ï¼Ÿè¯· <a href="/login">ç™»å½•æ­Œè¿·è´¦å·</a>
    </div>
{% endif %}

{% endblock %}
